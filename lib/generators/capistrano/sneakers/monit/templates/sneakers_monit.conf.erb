# Monit configuration for Sneakers : <%= fetch(:application) %>
check process <%= sneakers_monit_service_name %>
  with pidfile "<%= fetch(:sneakers_pid) %>"
  start program = "/bin/su - <%= sneakers_user(@role) %> -c 'cd <%= current_path %> && RAILS_ENV=<%= fetch(:sneakers_env) %> <%= SSHKit.config.command_map[:rake] %> sneakers:run'"
  stop program = "/bin/su -iu <%= sneakers_user(@role) %> -c 'kill -SIGTERM `cat <%= fetch(:sneakers_pid) %>`'"
